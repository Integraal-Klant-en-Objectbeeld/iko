<!DOCTYPE html>
<html layout:decorate="~{layout-v2.html}" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<body>
<!-- /* Content of this page will be decorated by the elements of layout-internal.html */ -->
<div layout:fragment="view-panel-content">
    <th:block th:fragment="details">
        <div
            th:replace="~{layout-v2 :: breadcrumb (${ {{'Connectors', '/admin/connectors'}, { connector.name, '/admin/connectors/' + connector.id } }})}"></div>
        <div
            th:replace="~{layout-v2 :: page-header (pageName='Connector', title=${connector.name}, subtext=${connector.tag})}"></div>

        <cds-layout>
            <cds-tabs value="instances" type="contained" class="cds--tabs cds--tabs--contained">
                <cds-tab id="tab-instances" target="panel-instances" value="instances">Instances</cds-tab>
                <cds-tab id="tab-connector-code" target="panel-connector-code" value="connector-code" selected="">
                    Connector Code
                </cds-tab>
                <cds-tab id="tab-endpoints" target="panel-endpoints" value="endpoints">Endpoints</cds-tab>
            </cds-tabs>

            <div id="panel-connector-code" role="tabpanel" aria-labelledby="tab-connector-code"
                 class="cds--tab-content cds--tab-content--interactive">
                <div style="display: flex; flex-flow: row; justify-content: flex-end; align-items: center;">
                <cds-button style=""
                            th:hx-get="@{|/admin/connectors/${connector.id}/edit|}"
                            hx-target="#modal-container"
                            kind="primary"
                >Edit Code
                </cds-button>
                </div>
                <div id="connector-code" style="border: 1px solid black; margin: 0.5em;" th:fragment="connector-code">
                <pre><code class="language-yaml">[[${connector.connectorCode}]]</code></pre>

                    <script type="text/javascript">
                        document.querySelectorAll('#panel-connector-code pre code').forEach((block) => {
                            hljs.highlightElement(block);
                        });
                    </script>
                </div>
            </div>

            <div id="panel-endpoints" role="tabpanel" aria-labelledby="tab-endpoints" hidden=""
                 class="cds--tab-content cds--tab-content--interactive">
                <cds-table id="endpoints-table" th:fragment="endpoints-table">
                    <cds-table-header-title slot="title">Endpoints</cds-table-header-title>
                    <cds-table-header-description slot="description">Overview of all connectors endpoints
                    </cds-table-header-description>
                    <cds-table-toolbar slot="toolbar">
                        <cds-table-toolbar-content>
                            <cds-button
                                th:hx-get="@{|/admin/connectors/${connector.id}/endpoints/create|}"
                                hx-target="#modal-container"
                                kind="primary"
                            >
                                Add endpoint
                                <svg
                                    focusable="false"
                                    preserveAspectRatio="xMidYMid meet"
                                    xmlns="http://www.w3.org/2000/svg"
                                    fill="currentColor"
                                    aria-hidden="true"
                                    width="16"
                                    height="16"
                                    viewBox="0 0 32 32"
                                    slot="icon">
                                    <path
                                        d="M17 15L17 8 15 8 15 15 8 15 8 17 15 17 15 24 17 24 17 17 24 17 24 15z"></path>
                                </svg>
                            </cds-button>
                        </cds-table-toolbar-content>
                    </cds-table-toolbar>
                    <!-- Header -->
                    <cds-table-head>
                        <cds-table-header-row>
                            <cds-table-header-cell>
                                Name
                            </cds-table-header-cell>
                            <cds-table-header-cell>
                                Description
                            </cds-table-header-cell>
                            <cds-table-header-cell>
                                Reference
                            </cds-table-header-cell>
                            <cds-table-header-cell>
                            </cds-table-header-cell>

                        </cds-table-header-row>
                    </cds-table-head>
                    <cds-table-body id="endpoints">
                        <cds-table-row th:each="endpoint: ${endpoints}">
                            <cds-table-cell th:text="${endpoint.name}"></cds-table-cell>
                            <cds-table-cell th:text="${endpoint.description}"></cds-table-cell>
                            <cds-table-cell th:text="${endpoint.operation}"></cds-table-cell>
                            <cds-table-cell class="app--table-cell-actions">
                                <cds-button kind="ghost"
                                            hx-confirm="Are you sure you want to delete this endpoint?"
                                            th:hx-delete="@{|/admin/connectors/${connector.id}/endpoints/${endpoint.id}|}"
                                            hx-swap="outerHTML"
                                            hx-target="#endpoints-table">
                                    Delete
                                    <svg focusable="false" preserveAspectRatio="xMidYMid meet"
                                         xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true"
                                         width="16" height="16" viewBox="0 0 32 32" slot="icon"
                                         class="cds--btn__icon">
                                        <path d="M12 12H14V24H12zM18 12H20V24H18z"></path>
                                        <path
                                            d="M4 6V8H6V28a2 2 0 002 2H24a2 2 0 002-2V8h2V6zM8 28V8H24V28zM12 2H20V4H12z"></path>
                                    </svg>
                                </cds-button>
                            </cds-table-cell>
                        </cds-table-row>
                    </cds-table-body>
                </cds-table>
            </div>
            <div id="panel-instances" role="tabpanel" aria-labelledby="tab-instances" hidden=""
                 class="cds--tab-content cds--tab-content--interactive"
            >
                <cds-table id="instance-table" th:fragment="instance-table">
                    <cds-table-header-title slot="title">Instances</cds-table-header-title>
                    <cds-table-header-description slot="description">Overview of all connectors instances
                    </cds-table-header-description>
                    <cds-table-toolbar slot="toolbar">
                        <cds-table-toolbar-content>
                            <cds-button
                                th:hx-get="@{|/admin/connectors/${connector.id}/instances/create|}"
                                hx-target="#modal-container"
                                kind="primary"
                            >
                                Add instance
                                <svg
                                    focusable="false"
                                    preserveAspectRatio="xMidYMid meet"
                                    xmlns="http://www.w3.org/2000/svg"
                                    fill="currentColor"
                                    aria-hidden="true"
                                    width="16"
                                    height="16"
                                    viewBox="0 0 32 32"
                                    slot="icon">
                                    <path
                                        d="M17 15L17 8 15 8 15 15 8 15 8 17 15 17 15 24 17 24 17 17 24 17 24 15z"></path>
                                </svg>
                            </cds-button>
                        </cds-table-toolbar-content>
                    </cds-table-toolbar>
                    <!-- Header -->
                    <cds-table-head>
                        <cds-table-header-row>
                            <cds-table-header-cell>
                                Name
                            </cds-table-header-cell>
                            <cds-table-header-cell>
                                Reference
                            </cds-table-header-cell>
                            <cds-table-header-cell>
                            </cds-table-header-cell>
                        </cds-table-header-row>
                    </cds-table-head>
                    <cds-table-body id="instances">
                        <cds-table-row th:each="instance: ${instances}">
                            <cds-table-cell th:text="${instance.name}"></cds-table-cell>
                            <cds-table-cell th:text="${instance.tag}"></cds-table-cell>
                            <cds-table-cell class="app--table-cell-actions">
                                <cds-button kind="ghost"
                                            th:hx-get="@{|/admin/connectors/${connector.id}/instances/${instance.id}|}"
                                            hx-push-url="true"
                                            hx-target="#view-panel">
                                   View
                                    <svg focusable="false" preserveAspectRatio="xMidYMid meet"
                                         xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true"
                                         width="16" height="16" viewBox="0 0 32 32" slot="icon"
                                         class="cds--btn__icon"><defs><style>.cls-1{fill:none;}</style></defs><title>view</title><path d="M30.94,15.66A16.69,16.69,0,0,0,16,5,16.69,16.69,0,0,0,1.06,15.66a1,1,0,0,0,0,.68A16.69,16.69,0,0,0,16,27,16.69,16.69,0,0,0,30.94,16.34,1,1,0,0,0,30.94,15.66ZM16,25c-5.3,0-10.9-3.93-12.93-9C5.1,10.93,10.7,7,16,7s10.9,3.93,12.93,9C26.9,21.07,21.3,25,16,25Z" transform="translate(0 0)"/><path d="M16,10a6,6,0,1,0,6,6A6,6,0,0,0,16,10Zm0,10a4,4,0,1,1,4-4A4,4,0,0,1,16,20Z" transform="translate(0 0)"/><rect id="_Transparent_Rectangle_" data-name="&lt;Transparent Rectangle&gt;" class="cls-1" width="32" height="32"/></svg>
                                </cds-button>
                                <cds-button kind="ghost"
                                            hx-confirm="Are you sure you want to delete this instance?"
                                            th:hx-delete="@{|/admin/connectors/${connector.id}/instances/${instance.id}|}"
                                            hx-swap="outerHTML"
                                            hx-target="#instance-table">
                                    Delete
                                    <svg focusable="false" preserveAspectRatio="xMidYMid meet"
                                         xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true"
                                         width="16" height="16" viewBox="0 0 32 32" slot="icon"
                                         class="cds--btn__icon">
                                        <path d="M12 12H14V24H12zM18 12H20V24H18z"></path>
                                        <path
                                            d="M4 6V8H6V28a2 2 0 002 2H24a2 2 0 002-2V8h2V6zM8 28V8H24V28zM12 2H20V4H12z"></path>
                                    </svg>
                                </cds-button>
                            </cds-table-cell>
                        </cds-table-row>
                    </cds-table-body>
                </cds-table>
            </div>
        </cds-layout>
    </th:block>
</div>
</body>
</html>
